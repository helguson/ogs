<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"></meta>
		<title>extendArrayTest</title>
		<script type="text/javascript">
			"use strict";

			function onLoad(){

				//console.log("onload dummy");
			}

			function onClick(){

				//console.log("onclick dummy");
			}

			window.MyArray = {};
			var MyArray = window.MyArray;
			MyArray.inject = function(value){

				//#######################
				//### private methods ###
				//#######################
				/**
				 * @brief applies 'injectPropertiesInto' to 'result'
				 * and to every array that is stored within 'result'
				**/
				var injectProperties = function(){

					var injectables = [result];

					while(injectables.length > 0){
						// dequeue first element
						var currentArray = injectables.shift();

						var additionalInjectables = currentArray.filter(Array.isArray);

						// enqueue additional elements
						injectables = injectables.concat(
							additionalInjectables
						);

						injectPropertiesInto(currentArray);
					}
				}

				var injectPropertiesInto = function(object){

					injectNonPrototypicPropertiesInto(object);
					injectPrototypicPropertiesInto(object, MyArray.prototype);
				};

				var injectNonPrototypicPropertiesInto = function(object){

					object.beep = "non prototypic beep";
				};

				var injectPrototypicPropertiesInto = function(object, prototype){

					for(var key in prototype){
						if(prototype.hasOwnProperty(key)){
							Object.defineProperty(
								object,
								key,
								{value: prototype[key]}
							);
						}
					}
				};

				//#############
				//### setUp ###
				//#############
				var result = [];

				if(arguments.length > 0){
					result = value;
				}

				injectProperties();

				return result;
			}
			MyArray.prototype = {};
			MyArray.prototype.prototypicBeep = "prototypic beep";


		</script>
	</head>
	<body onload="onLoad()" onclick="onClick()">
	</body>
</html>
